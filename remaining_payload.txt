ðŸ FINAL REMAINING PIECES FOR REVIEW
==================================================

--- REMAINING BATCH 1 | src/alembic/env.py ---
### FILE: src/alembic/env.py
```python
from __future__ import annotations

import os
from logging.config import fileConfig

from alembic import context
from dotenv import load_dotenv
from sqlalchemy import engine_from_config, pool

from app.database import Base
import app.models  # registers all models

config = context.config

if config.config_file_name is not None:
    fileConfig(config.config_file_name)

# Load .env so DATABASE_URL is available
load_dotenv()

target_metadata = Base.metadata


def get_url() -> str:
    url = os.getenv("DATABASE_URL")
    if not url:
        raise RuntimeError("DATABASE_URL is not set")
    return url


def run_migrations_offline() -> None:
    context.configure(
        url=get_url(),
        target_metadata=target_metadata,
        literal_binds=True,
        dialect_opts={"paramstyle": "named"},
        compare_type=True,
    )

    with context.begin_transaction():
        context.run_migrations()


def run_migrations_online() -> None:
    configuration = config.get_section(config.config_ini_section) or {}
    configuration["sqlalchemy.url"] = get_url()

    connectable = engine_from_config(
        configuration,
        prefix="sqlalchemy.",
        poolclass=pool.NullPool,
    )

    with connectable.connect() as connection:
        context.configure(
            connection=connection,
            target_metadata=target_metadata,
            compare_type=True,
        )

        with context.begin_transaction():
            context.run_migrations()


if context.is_offline_mode():
    run_migrations_offline()
else:
    run_migrations_online()
```

==================================================

--- REMAINING BATCH 2 | src/alembic/versions/8839c3bb117f_initial_clean_baseline.py ---
### FILE: src/alembic/versions/8839c3bb117f_initial_clean_baseline.py
```python
"""initial_clean_baseline

Revision ID: 8839c3bb117f
Revises: 
Create Date: 2026-02-26 12:13:48.704284

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision: str = '8839c3bb117f'
down_revision: Union[str, Sequence[str], None] = None
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    """Upgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    pass
    # ### end Alembic commands ###


def downgrade() -> None:
    """Downgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    pass
    # ### end Alembic commands ###

```

==================================================

--- REMAINING BATCH 3 | scripts/ops/run.sh ---
### FILE: scripts/ops/run.sh
```bash
#!/usr/bin/env bash
set -euo pipefail

cd "$(dirname "$0")/../.."

echo "Starting backend (src-layout)..."
uv run python -m uvicorn app.main:app --host 0.0.0.0 --port 8080 --app-dir src --reload
```

==================================================

--- REMAINING BATCH 4 | scripts/ops/ready.sh ---
### FILE: scripts/ops/ready.sh
```bash
#!/usr/bin/env bash
set -euo pipefail

# Navigate to project root
cd "$(dirname "$0")/../.."

clear
echo "ðŸ›¡ï¸  AAA-BACKEND SYSTEMATIC GUARD"
echo "------------------------------------------------------------"

# Run diagnostic script and capture token
# We redirect stderr to null to keep the TOKEN capture clean
DIAG_OUTPUT=$(uv run --env-file .env python scripts/ops/check_env.py --token 2>/dev/null || echo "FAILED")

if [[ "$DIAG_OUTPUT" == "FAILED" ]]; then
    echo "âŒ Critical environment failure."
    exit 1
fi

# Extract token using sed
TOKEN=$(echo "$DIAG_OUTPUT" | sed -n 's/.*TOKEN_START:\(.*\):TOKEN_END.*/\1/p')

# Display diagnostic logs but hide the raw TOKEN_START line
echo "$DIAG_OUTPUT" | grep -v "TOKEN_START"

# Ghost Check: Clean up port 8080
lsof -ti:8080 | xargs kill -9 2>/dev/null || true

echo "------------------------------------------------------------"
echo "ðŸ”¡ CHEAT SHEET"
echo "   Endpoint : http://localhost:8080/api/dining-rooms/"
[[ -n "$TOKEN" ]] && echo "   Token    : Generated (Ready for curl)" || echo "   Token    : âŒ Check check_env.py"

if [[ -n "$TOKEN" ]]; then
    echo "ðŸ“¡ AUTH SMOKE TEST..."
    # Quick HEAD request to check if server is already responsive (or just check path)
    curl -I -s -H "Authorization: Bearer $TOKEN" http://localhost:8080/api/auth/me | grep "HTTP" || echo "   â„¹ï¸ Server offline (Ready to boot)"
fi
echo "------------------------------------------------------------"

read -p "ðŸš€ Start Server? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    uv run python run.py
fi
```

==================================================

--- REMAINING BATCH 5 | scripts/ops/dev.sh ---
### FILE: scripts/ops/dev.sh
```bash
#!/usr/bin/env bash
# Move to project root
cd "$(dirname "$0")/../.."
# Run the working script
sh scripts/ops/ready.sh

```

==================================================

--- REMAINING BATCH 6 | src/app/models/__init__.py ---
### FILE: src/app/models/__init__.py
```python
# app/models/__init__.py
from .revoked_token import RevokedToken
from .user import User
from .member import Member
from .reservation import Reservation
from .reservation_attendee import ReservationAttendee
from .menu_item import MenuItem
from .order import Order
from .order_item import OrderItem
from .message import Message
from .dining_room import DiningRoom
from .table import Table
from .seat_assignment import SeatAssignment

```

==================================================

--- REMAINING BATCH 7 | src/app/api/routes/__init__.py ---
### FILE: src/app/api/routes/__init__.py
```python
# app/api/routes/__init__.py
from . import auth  # noqa: F401
from . import members  # noqa: F401
from . import reservations  # noqa: F401
from . import reservation_attendees  # noqa: F401
from . import menu_items  # noqa: F401
from . import orders  # noqa: F401
from . import order_items  # noqa: F401
from . import dining_rooms  # noqa: F401
from . import tables  # noqa: F401
from . import seat_assignments  # noqa: F401
from . import messages  # noqa: F401
```

==================================================

--- REMAINING BATCH 8 | Taskfile.yml ---
### FILE: Taskfile.yml
```bash
version: "3"

tasks:
  verify:
    desc: "Verify toolchain + venv + env + infra"
    cmds:
      - sh scripts/ops/verify.sh

  run:
    desc: "Run API server"
    cmds:
      - uv run python run.py

  dev:
    desc: "Verify + run"
    cmds:
      - task: verify
      - task: run

  seed:
    desc: "Reset and seed data (canonical)"
    cmds:
      - uv run python scripts/ops/seed_db.py

  up:
    desc: "Apply migrations via python module"
    cmds:
      - uv run python -m alembic upgrade head

  migrate:
    desc: "Generate migrations via python module"
    cmds:
      - uv run python -m alembic revision --autogenerate -m "{{.CLI_ARGS}}"

```

==================================================

--- REMAINING BATCH 9 | pyproject.toml ---
### FILE: pyproject.toml
```toml
[project]
name = "aaa-backend"
version = "0.1.0"
description = "FastAPI backend"
readme = "README.md"
requires-python = ">=3.12"
# Dependencies go HERE, under [project]
dependencies = [
    "alembic>=1.18.4",
    "bcrypt<4",
    "fastapi>=0.129.0",
    "passlib[bcrypt]>=1.7.4",
    "psycopg2-binary>=2.9.11",
    "psycopg[binary]>=3.3.3",
    "pydantic-settings>=2.13.1",
    "pydantic[email]>=2.12.5",
    "python-dotenv>=1.2.1",
    "python-jose[cryptography]>=3.5.0",
    "python-multipart>=0.0.22",
    "sqlalchemy>=2.0.46",
    "uvicorn[standard]>=0.41.0",
]

[build-system]
requires = ["setuptools>=61.0"]
build-backend = "setuptools.build_meta"

[tool.setuptools]
package-dir = {"" = "src"}

[tool.setuptools.packages.find]
where = ["src"]

[tool.pytest.ini_options]
pythonpath = ["src"]

```

==================================================

